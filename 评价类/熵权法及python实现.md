### 熵权法及python实现

#### 1、熵权法（Python实现）

熵权法是通过寻找数据本身的规律来赋权重的一种方法。

熵是热力学单位，在数学中，信息熵表示事件所包含的信息量的期望。根据定义，对于某项指标，可以用熵值来判断某个指标的离散程度，其熵值越小，指标的离散程度越大，该指标对综合评价的影响（权重）越大。

熵权法是一种客观赋权方法。在具体使用过程中，熵权法根据各指标的变异程度，利用信息熵计算出各指标的熵权，从而得出较为客观的指标权重。



#### 2、实战：

**请根据下表给出的10个学生8门课的成绩，给出这10个学生评奖学金的评分排序。**

| 学生编号 | 语文 | 数学 | 物理 | 化学 | 英语 | 政治 | 生物 | 历史 |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 1        | 93   | 66   | 86   | 88   | 77   | 71   | 90   | 94   |
| 2        | 97   | 99   | 61   | 61   | 75   | 87   | 70   | 70   |
| 3        | 65   | 99   | 94   | 71   | 91   | 86   | 80   | 93   |
| 4        | 97   | 79   | 98   | 61   | 92   | 66   | 88   | 69   |
| 5        | 85   | 92   | 87   | 63   | 67   | 64   | 96   | 98   |
| 6        | 63   | 65   | 91   | 93   | 80   | 80   | 99   | 74   |
| 7        | 71   | 77   | 90   | 88   | 78   | 99   | 82   | 68   |
| 8        | 82   | 97   | 76   | 73   | 86   | 73   | 65   | 70   |
| 9        | 99   | 92   | 86   | 98   | 89   | 83   | 66   | 85   |
| 10       | 99   | 99   | 67   | 61   | 90   | 69   | 70   | 79   |

熵权法是一种客观赋权方法，常用于多指标综合评价问题。该方法基于信息熵的概念，通过各指标值的离散程度来确定各指标的权重，指标值的离散程度越大，熵值越小，该指标的权重越大。以下是使用熵权法进行权重计算的步骤：

1. 数据标准化处理：由于各指标量纲和数量级可能不同，需要对数据进行无量纲化处理，使之可比。
2. 计算指标的比重：对于每个指标，计算每个样本值占该指标总和的比例。
3. 计算指标的熵值：根据比重，计算每个指标的熵值。
4. 计算指标的差异系数：差异系数等于1减去熵值。
5. 计算指标权重：各指标的差异系数除以差异系数之和即为各指标的权重。

```python
import pandas as pd
import numpy as np

# 从Excel文件中读取数据
df = pd.read_excel('data/成绩.xlsx', index_col='学生编号')

# 数据标准化处理（这里使用的是线性变换的方法，即归一化处理）
df_normalized = (df - df.min()) / (df.max() - df.min())

# 计算指标的比重
proportions = df_normalized / df_normalized.sum()

# 计算指标的熵值
e = (-1/np.log(len(df))) * (proportions * np.log(proportions)).sum()

# 计算指标的差异系数
d = 1 - e

# 计算指标权重
weights = d / d.sum()

print(weights)

```

```
语文    0.100673
数学    0.099919
物理    0.070044
化学    0.214087
英语    0.068080
政治    0.127126
生物    0.136576
历史    0.183496
```

以下是计算每个学生的综合得分并确定最优秀学生的步骤：

1. 根据前面的熵权法计算出每个学科的权重。
2. 将每个学生在各个学科上的得分乘以对应的权重。
3. 对每个学生的加权得分求和，得到综合得分。
4. 比较所有学生的综合得分，得分最高的学生即为最优秀的学生。

```python
import pandas as pd
import numpy as np

# 从Excel文件中读取数据
df = pd.read_excel('data/成绩.xlsx', index_col='学生编号')

# 数据标准化处理（这里使用的是线性变换的方法，即归一化处理）
df_normalized = (df - df.min()) / (df.max() - df.min())

# 计算指标的比重
proportions = df_normalized / df_normalized.sum()

# 防止比重为0时log(0)为负无穷，用一个非常小的正数替换0
proportions = proportions.replace(0, 1e-9)

# 计算指标的熵值
e = (-1/np.log(len(df))) * (proportions * np.log(proportions)).sum()

# 计算指标的差异系数
d = 1 - e

# 计算指标权重
weights = d / d.sum()

# 计算每个学生的加权得分
df['综合得分'] = df_normalized.dot(weights)

# 找出综合得分最高的学生
best_student = df['综合得分'].idxmax()

print(f"最优秀的学生编号是：{best_student}")
print(df.loc[best_student])

```

```
最优秀的学生编号是：9
语文      99.000000
数学      92.000000
物理      86.000000
化学      98.000000
英语      89.000000
政治      83.000000
生物      66.000000
历史      85.000000
综合得分     0.678353
```